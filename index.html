<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SPY–HYG Divergence</title>
  <link rel="stylesheet" href="styles.css">
  <meta name="description" content="Simple SPY–HYG divergence signal computed client-side from JSON time-series built by GitHub Actions." />
</head>
<body>
  <!-- Top Section: Lookback & Divergence Explanation -->
  <div class="card">
    <div style="display:flex;align-items:center;gap:16px">
      <div>
        <h1 style="margin:0 0 4px 0">Divergence Dashboard</h1>
        <div class="muted" id="meta">Loading data…</div>
      </div>
      <div class="pill">
        <div class="muted">Lookback Period</div>
        <div>
          <select id="lookbackSelect" style="background:#17181b;color:#e9e9ea;border:1px solid #333;padding:6px 8px;border-radius:6px;font-size:14px;cursor:pointer">
            <option value="20" selected>20 days</option>
            <option value="50">50 days</option>
            <option value="100">100 days</option>
          </select>
        </div>
      </div>
      <div class="pill">
        <div class="muted">Pivot Selection</div>
        <div>
          <select id="pivotModeSelect" style="background:#17181b;color:#e9e9ea;border:1px solid #333;padding:6px 8px;border-radius:6px;font-size:14px;cursor:pointer">
            <option value="highest" selected>2 Highest by Price</option>
            <option value="recent">Last 2 Chronologically</option>
            <option value="highest-to-current">HH → Last Close</option>
          </select>
        </div>
      </div>
      <div class="pill">
        <div class="muted">Swing Window</div>
        <div>
          <select id="barsSelect" style="background:#17181b;color:#e9e9ea;border:1px solid #333;padding:6px 8px;border-radius:6px;font-size:14px;cursor:pointer">
            <option value="auto" selected>Auto-scale</option>
            <option value="2">2 days</option>
            <option value="3">3 days</option>
            <option value="5">5 days</option>
            <option value="7">7 days</option>
            <option value="10">10 days</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Divergence Pairs Columns -->
  <div class="pairs-container">
    <!-- SPY ↔ HYG -->
    <div class="pair-column">
      <h2>SPY ↔ HYG</h2>
      <div class="trends">
        <div class="trend-item">
          <span class="muted">SPY Trend</span>
          <code id="spy-hyg-spy-trend"></code>
        </div>
        <div class="trend-item">
          <span class="muted">HYG Trend</span>
          <code id="spy-hyg-hyg-trend"></code>
        </div>
      </div>
      <div class="divergence-signal" id="spy-hyg-signal"></div>

      <div class="chart-container">
        <div class="chart-title">SPY Price</div>
        <div id="chart-spy-hyg-spy" style="width:100%;height:150px"></div>
      </div>
      <div class="chart-container">
        <div class="chart-title">HYG Price</div>
        <div id="chart-spy-hyg-hyg" style="width:100%;height:150px"></div>
      </div>
      <div class="chart-container">
        <div class="chart-title">SPY/HYG Ratio</div>
        <div id="chart-spy-hyg-ratio" style="width:100%;height:150px"></div>
      </div>
    </div>

    <!-- QQQ ↔ TLT -->
    <div class="pair-column">
      <h2>QQQ ↔ TLT</h2>
      <div class="trends">
        <div class="trend-item">
          <span class="muted">QQQ Trend</span>
          <code id="qqq-tlt-qqq-trend"></code>
        </div>
        <div class="trend-item">
          <span class="muted">TLT Trend</span>
          <code id="qqq-tlt-tlt-trend"></code>
        </div>
      </div>
      <div class="divergence-signal" id="qqq-tlt-signal"></div>

      <div class="chart-container">
        <div class="chart-title">QQQ Price</div>
        <div id="chart-qqq-tlt-qqq" style="width:100%;height:150px"></div>
      </div>
      <div class="chart-container">
        <div class="chart-title">TLT Price</div>
        <div id="chart-qqq-tlt-tlt" style="width:100%;height:150px"></div>
      </div>
      <div class="chart-container">
        <div class="chart-title">QQQ/TLT Ratio</div>
        <div id="chart-qqq-tlt-ratio" style="width:100%;height:150px"></div>
      </div>
    </div>

    <!-- SPY ↔ GLD -->
    <div class="pair-column">
      <h2>SPY ↔ GLD</h2>
      <div class="trends">
        <div class="trend-item">
          <span class="muted">SPY Trend</span>
          <code id="spy-gld-spy-trend"></code>
        </div>
        <div class="trend-item">
          <span class="muted">GLD Trend</span>
          <code id="spy-gld-gld-trend"></code>
        </div>
      </div>
      <div class="divergence-signal" id="spy-gld-signal"></div>

      <div class="chart-container">
        <div class="chart-title">SPY Price</div>
        <div id="chart-spy-gld-spy" style="width:100%;height:150px"></div>
      </div>
      <div class="chart-container">
        <div class="chart-title">GLD Price</div>
        <div id="chart-spy-gld-gld" style="width:100%;height:150px"></div>
      </div>
      <div class="chart-container">
        <div class="chart-title">SPY/GLD Ratio</div>
        <div id="chart-spy-gld-ratio" style="width:100%;height:150px"></div>
      </div>
    </div>

    <!-- SPY ↔ IWM -->
    <div class="pair-column">
      <h2>SPY ↔ IWM</h2>
      <div class="trends">
        <div class="trend-item">
          <span class="muted">SPY Trend</span>
          <code id="spy-iwm-spy-trend"></code>
        </div>
        <div class="trend-item">
          <span class="muted">IWM Trend</span>
          <code id="spy-iwm-iwm-trend"></code>
        </div>
      </div>
      <div class="divergence-signal" id="spy-iwm-signal"></div>

      <div class="chart-container">
        <div class="chart-title">SPY Price</div>
        <div id="chart-spy-iwm-spy" style="width:100%;height:150px"></div>
      </div>
      <div class="chart-container">
        <div class="chart-title">IWM Price</div>
        <div id="chart-spy-iwm-iwm" style="width:100%;height:150px"></div>
      </div>
      <div class="chart-container">
        <div class="chart-title">SPY/IWM Ratio</div>
        <div id="chart-spy-iwm-ratio" style="width:100%;height:150px"></div>
      </div>
    </div>
  </div>

  <div class="card" style="margin-top:18px">
    <h2 style="font-size:16px;margin:0 0 10px">Swing High Detection Logic</h2>
    <div class="muted" style="font-size:13px;line-height:1.7">
      • <b>Find swing highs:</b> Identify all local peaks in the price chart where price is higher than surrounding days<br>
      • <b>Select the 2 highest:</b> Sort all peaks by price and take the top 2 highest (shown as gold dots on charts)<br>
      • <b>Draw trend line:</b> Connect the 2 highest peaks chronologically. If the line slopes up = "Higher Highs ↗", down = "Lower Highs ↘"<br>
      • <b>Detect divergence:</b> When one asset's trend line goes up while another's goes down<br>
      <br>
      <b>Bearish divergence:</b> SPY makes higher highs while HYG makes lower highs (risk-off warning)<br>
      <b>Bullish divergence:</b> SPY makes lower highs while HYG makes higher highs (potential reversal)<br>
      <b>Aligned:</b> Both assets trending in the same direction (confirmation)
    </div>
  </div>

  <div class="card" style="margin-top:18px">
    <div class="muted" style="text-align:center;font-size:12px">
      Data provided by <a href="https://stooq.com" target="_blank" rel="noopener" style="color:#7aa2f7;text-decoration:none">Stooq</a>
      · Inspired by <a href="https://tradebrigade.co" target="_blank" rel="noopener" style="color:#7aa2f7;text-decoration:none">Trade Brigade</a>
      · Vibe-coded with <a href="https://claude.ai/code" target="_blank" rel="noopener" style="color:#7aa2f7;text-decoration:none">Claude Code</a>
    </div>
  </div>

<script src="app.js"></script>
</body>
</html>
