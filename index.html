<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SPY–HYG Divergence</title>
  <link rel="stylesheet" href="styles.css">
  <meta name="description" content="Simple SPY–HYG divergence signal computed client-side from JSON time-series built by GitHub Actions." />
</head>
<body>
  <!-- Top Section: Lookback & Divergence Explanation -->
  <div class="card">
    <h1>Divergence Dashboard</h1>
    <div class="muted" id="meta">Loading data…</div>

    <div class="row" style="margin-top:12px">
      <div class="pill">
        <div class="muted">Lookback Period</div>
        <div>
          <select id="lookbackSelect" style="background:#17181b;color:#e9e9ea;border:1px solid #333;padding:6px 8px;border-radius:6px;font-size:14px;cursor:pointer">
            <option value="20" selected>20 days</option>
            <option value="50">50 days</option>
            <option value="100">100 days</option>
          </select>
        </div>
      </div>
    </div>

    <div class="muted" style="margin-top:14px;font-size:13px;line-height:1.6">
      <b>Bearish divergence:</b> Asset 1 makes higher highs while Asset 2 makes lower highs (risk-off warning).
      <br>
      <b>Bullish divergence:</b> Asset 1 makes lower highs while Asset 2 makes higher highs (potential reversal).
      <br>
      <b>Aligned:</b> Both assets trending in the same direction (confirmation).
    </div>
  </div>

  <!-- Divergence Pairs Columns -->
  <div class="pairs-container">
    <!-- SPY ↔ HYG -->
    <div class="pair-column">
      <h2>SPY ↔ HYG</h2>
      <div class="trends">
        <div class="trend-item">
          <span class="muted">SPY Trend</span>
          <code id="spy-hyg-spy-trend"></code>
        </div>
        <div class="trend-item">
          <span class="muted">HYG Trend</span>
          <code id="spy-hyg-hyg-trend"></code>
        </div>
      </div>
      <div class="divergence-signal" id="spy-hyg-signal"></div>

      <div class="chart-container">
        <div class="chart-title">SPY Price</div>
        <div id="chart-spy-hyg-spy" style="width:100%;height:150px"></div>
      </div>
      <div class="chart-container">
        <div class="chart-title">HYG Price</div>
        <div id="chart-spy-hyg-hyg" style="width:100%;height:150px"></div>
      </div>
      <div class="chart-container">
        <div class="chart-title">SPY/HYG Ratio</div>
        <div id="chart-spy-hyg-ratio" style="width:100%;height:150px"></div>
      </div>
    </div>

    <!-- QQQ ↔ TLT -->
    <div class="pair-column">
      <h2>QQQ ↔ TLT</h2>
      <div class="trends">
        <div class="trend-item">
          <span class="muted">QQQ Trend</span>
          <code id="qqq-tlt-qqq-trend"></code>
        </div>
        <div class="trend-item">
          <span class="muted">TLT Trend</span>
          <code id="qqq-tlt-tlt-trend"></code>
        </div>
      </div>
      <div class="divergence-signal" id="qqq-tlt-signal"></div>

      <div class="chart-container">
        <div class="chart-title">QQQ Price</div>
        <div id="chart-qqq-tlt-qqq" style="width:100%;height:150px"></div>
      </div>
      <div class="chart-container">
        <div class="chart-title">TLT Price</div>
        <div id="chart-qqq-tlt-tlt" style="width:100%;height:150px"></div>
      </div>
      <div class="chart-container">
        <div class="chart-title">QQQ/TLT Ratio</div>
        <div id="chart-qqq-tlt-ratio" style="width:100%;height:150px"></div>
      </div>
    </div>
  </div>

  <div class="card" style="margin-top:18px">
    <h2 style="font-size:16px;margin:0 0 10px">Swing High Detection Logic</h2>
    <div class="muted" style="font-size:13px;line-height:1.7">
      <b>1. Identify swing highs:</b> A bar is a swing high if its price is higher than all neighboring bars within a scaled window (20 days = 2 bars each side, 50 days = 5 bars, 100 days = 10 bars)
      <br><br>
      <b>2. Scan all bars:</b> Iterate through every bar in the lookback period to find all swing highs
      <br><br>
      <b>3. Select top 2 by price:</b> Sort all identified swing highs by price (descending) and take the 2 highest
      <br><br>
      <b>4. Calculate trend:</b> Connect the 2 swing highs chronologically. If second > first = "Higher Highs ↗", if second < first = "Lower Highs ↘"
      <br><br>
      <b>5. Divergence:</b> Occurs when SPY and HYG trends move in opposite directions (e.g., SPY higher highs + HYG lower highs = bearish divergence)
    </div>
  </div>

  <div class="card" style="margin-top:18px">
    <div class="muted" style="text-align:center;font-size:12px">
      Data provided by <a href="https://stooq.com" target="_blank" rel="noopener" style="color:#7aa2f7;text-decoration:none">Stooq</a>
      · Inspired by <a href="https://tradebrigade.co" target="_blank" rel="noopener" style="color:#7aa2f7;text-decoration:none">Trade Brigade</a>
      · Vibe-coded with <a href="https://claude.ai/code" target="_blank" rel="noopener" style="color:#7aa2f7;text-decoration:none">Claude Code</a>
    </div>
  </div>

<script src="app.js"></script>
</body>
</html>
